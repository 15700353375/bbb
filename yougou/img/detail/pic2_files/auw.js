!function(a,b){function c(a){return"[object Function]"===Object.prototype.toString.call(a)}function d(a){if(!h[a])throw new Error("Module "+a+" is not defined.");var b=h[a];return b.inited===!1&&e(a),b.ret}function e(a){var e={},f=h[a];if(c(h[a].factory)){var g=h[a].factory.apply(b,[d,e,b]);f.ret=g===b?e:g}else f.ret=h[a].factory;f.inited=!0}function f(a,b,d){if(h[a])throw new Error("Module "+a+" has been defined already.");c(b)&&(d=b),h[a]={factory:d,inited:!1},a===g&&e(a)}var g="AppMain";if(!a.sg_define){for(var h={},i=document.getElementsByTagName("script"),j=0,k=i.length;k>j&&!g;j++)g=i[j].getAttribute("data-main");if(!g)throw new Error("No data-main attribute in script tag.");a.sg_define=f,a.sg_require=d}}(window),sg_define("pe/Config",function(){var a={form:{FormName:"UploadContentForm",IfameName:"UploadContentIframe",UploadUrl:"http://dsp.brand.sogou.com/auw_log_print"},doc:{url:"",title:"",mypos:"",metakeywords:"",metadescription:"",lastmodified:"",maincontent:"",charset:""}};return a}),sg_define("pe/Util",function(){var a=document;"function"!=typeof Function.prototype.inherit&&(Function.prototype.inherit=function(a){"function"==typeof a&&(this.prototype=new a,this.prototype.parent=a(),this.prototype.constructor=this)});var b={isFunction:function(a){return"[object Function]"===Object.prototype.toString.call(a)},findPos:function(a){var b={x:0,y:0};if(document.documentElement.getBoundingClientRect())b.x=a.getBoundingClientRect().left+this.scroll().left,b.y=a.getBoundingClientRect().top+this.scroll().top;else for(;a;)b.x+=a.offsetLeft,b.y+=a.offsetTop,a=a.offsetParent;return b},indexOf:function(a,b){if(a.indexOf)return a.indexOf(b);var c=-1;return this.each(a,function(a){return this[a]===b?(c=a,!1):void 0}),c},each:function(a,b,c){if(void 0!==a&&null!==a){if(void 0===a.length||this.isFunction(a)){for(var d in a)if(a.hasOwnProperty(d)&&b.call(c||a[d],d,a[d])===!1)break}else for(var e=0;e<a.length&&b.call(c||a,e,a[e])!==!1;e++);return a}},css:function(){var a=function(a,b){var c="";if("float"==b&&(b=document.defaultView?"float":"styleFloat"),a.style[b])c=a.style[b];else if(a.currentStyle)c=a.currentStyle[b];else if(document.defaultView&&document.defaultView.getComputedStyle){b=b.replace(/([A-Z])/g,"-$1").toLowerCase();var d=document.defaultView.getComputedStyle(a,"");c=d&&d.getPropertyValue(b)}else c=null;if("auto"!=c&&-1===c.indexOf("%")||"width"!==b.toLowerCase()&&"height"!==b.toLowerCase()||"none"==a.style.display||-1===c.indexOf("%")||(c=a["offset"+b.charAt(0).toUpperCase()+b.substring(1).toLowerCase()]+"px"),"opacity"==b)try{c=a.filters["DXImageTransform.Microsoft.Alpha"].opacity,c/=100}catch(e){try{c=a.filters("alpha").opacity}catch(f){}}return c};return function(b,c){return"string"==typeof c?a(b,c):void this.each(c,function(a,c){b.style[a]=c})}}(),scroll:function(){return{left:document.documentElement.scrollLeft+document.body.scrollLeft,top:document.documentElement.scrollTop+document.body.scrollTop}},browser:function(){return{isIE:-1!=navigator.appVersion.indexOf("MSIE",0),isSafari:-1!=navigator.appVersion.indexOf("WebKit",0),isFirefox:-1!=navigator.userAgent.indexOf("Firefox",0),isIpad:navigator.userAgent.indexOf("WebKit")>0&&navigator.userAgent.indexOf("iPad")>0,isIphone:navigator.userAgent.indexOf("WebKit")>0&&navigator.userAgent.indexOf("iPhone")>0,isChrome:navigator.userAgent.indexOf("WebKit")>0&&navigator.userAgent.indexOf("Chrome")>0}}(),trim:function(a){return"string"!=typeof a?a:a.replace(/^\s+/,"").replace(/\s+$/,"")},extend:function(a,b,c){if("object"!=typeof b)return!1;for(var d in b)a[d]="undefined"!=typeof a[d]&&c?[a[d],b[d]]:b[d]},el:function(b){return a.getElementById(b)},mkel:function(b,c){try{var d=a.createElement(b);return c&&c.appendChild(d),d}catch(e){return!1}},addEvent:function(a,b,c){return a.nodeType&&1==a.nodeType?void(this.browser.isIE?a.attachEvent("on"+b,c):a.addEventListener(b,c,!1)):!1},deleteEvent:function(a,b,c){return a.nodeType&&1==a.nodeType?void(this.browser.isIE?a.detachEvent("on"+b,c):a.removeEventListener(b,c,!1)):!1},wrapperEvent:function(a){var b={target:this.browser.isIE?a.srcElement:a.target,offsetX:this.browser.isIE?a.offsetX:a.layerX,offsetY:this.browser.isIE?a.offsetY:a.layerY,x:this.browser.isIE?a.x:a.pageX,y:this.browser.isIE?a.y:a.pageY};return b},enableDrag:function(a){var b=window;"string"==typeof a&&(a=this.el(a)),a.nodeType&&1==a.nodeType&&"div"==a.tagName.toLowercase()&&(a.style.position="absolute",this.addEvent(a,"mousedown",function(a){if("undefined"!=typeof b.YNoteDragObject&&null!=b.YNoteDragObject)return!1;var c=this.wrapperEvent(a);b.YNoteDragObject={element:c.target,startX:c.offsetX,startY:c.offsetY}}),"undefined"==typeof b.YNoteDragObject&&(this.addEvent(b.document,"mouseup",function(){null!=b.YNoteDragObject&&(b.YNoteDragObject=null)}),this.addEvent(b.document,"mousemove",function(a){if("undefined"!=typeof b.YNoteDragObject&&null!=b.YNoteDragObject){var c=this.wrapperEvent(a);b.YNoteDragObject.element.style.left=c.x-b.YNoteDragObject.startX+"px",b.YNoteDragObject.element.style.top=c.y-b.YNoteDragObject.startY+"px"}})))},getCharSet:function(){return this.browser.isIE?document.charset.toLowerCase():document.characterSet.toLowerCase()},HTMLEncode:function(a){var b="",c=a.length,d=navigator.userAgent.toLowerCase(),e=/msie/.test(d)?parseFloat(d.match(/msie ([\d.]+)/)[1]):!1;if(e>=7)for(var f=0;c>f;f++)b+=a.charCodeAt(f)+" ";else for(var f=0;f<a.length;f++){var g=a.charCodeAt(f),h=a[f];b+=g>127?"&#"+g+";":">"==h?"&gt;":"<"==h?"&lt;":"&"==h?"&amp;":a.charAt(f)}return b},unicodeEncode:function(a){var b="";if("string"==typeof a)for(var c=0;c<a.length;c++){var d=a.charCodeAt(c);b+=d>127?"&#"+d+";":a.charAt(c)}return b},getTopWindowInSameDomain:function(a){for(var b=a;b.parent!=b.self;)try{{b.parent.document.title}b=b.parent}catch(c){break}return b},getInnerText:function(a){var b=a.innerText||a.textContent||"";return b=this.trim(b)},getHostname:function(){var a=document.location.href.match(/^.*?:\/\/(www\.)?(.*?)(\/|$)/);return a?a[2]:null}};return b}),sg_define("pe/Page",function(){var a=sg_require("pe/Util"),b=sg_require("pe/Article"),c=function(a,b){this.win=a,this.contentDocument=b};return c.prototype={IGNORE_TAGS:["HTML","HEAD","META","TITLE","SCRIPT","STYLE","LINK","IMG","FORM","INPUT","BODY","BUTTON","TEXTAREA","SELECT","OPTION","LABEL","IFRAME","A","OBJECT","PARAM","EMBED","NOSCRIPT","EM","B","STRONG","I","INS","BR","HR","PRE","H1","H2","H3","H4","H5","CITE"],getMainArticle:function(){var a=null,b="";if(location&&(b=location.hostname),/\b(google|facebook|twitter)\b/i.test(b))return null;var c=this.getAllArticle();if(!c||!c.length)return null;c.sort(function(a,b){return b.weight-a.weight});for(var d=0;2>d&&(a=c[0],c.splice(0,1),a&&a.weight<200&&(a=null),!a);d++);return a?a:null},getMetaKeywords:function(){for(var a="",b=this.contentDocument.getElementsByTagName("meta"),c=0;c<b.length;c++)if("keywords"==b[c].name.toLowerCase()){a=b[c].content;break}return a},getMetaDescription:function(){for(var a="",b=this.contentDocument.getElementsByTagName("meta"),c=0;c<b.length;c++)if("description"==b[c].name.toLowerCase()){a=b[c].content;break}return a},getTitle:function(){return this.contentDocument.title},getUrl:function(){var a=this.win,b="";try{b=this.contentDocument.location,a.parent!=a.self&&(b=this.contentDocument.referrer||this.contentDocument.location)}catch(c){b=""}return b},getLastModified:function(){return this.contentDocument.lastModified},getCharset:function(){return this.contentDocument.charset||this.contentDocument.characterSet||""},getAllArticle:function(){for(var a=this.contentDocument.getElementsByTagName("*"),c=[],d=0,e=a.length;e>d;d++){var f=a[d];this._checkTagName(f)&&this._checkSize(f)&&this._checkVisibility(f)&&(c[c.length]=new b(f))}return c},_checkTagName:function(b){return-1==a.indexOf(this.IGNORE_TAGS,b.tagName)},_checkVisibility:function(b){return!("hidden"==a.css(b,"visibility")||"none"==a.css(b,"display")||parseInt(a.css(b,"height"))<=0||parseInt(a.css(b,"width"))<=0)},_checkSize:function(a){return a.offsetWidth>300&&a.offsetHeight>150}},c}),sg_define("pe/Article",function(){var a=sg_require("pe/Util"),b=function(b){this.elem=b,this.offset=a.findPos(b),this._texts=this._getAllTexts(b,6),this.weight=this.calcWeight()};return b.prototype={IGNORE_TAGS:["OPTION","SCRIPT","STYLE","UL","LI","IFRAME"],TITLE_TAGS:["H1","H2","H3","H4","H5","H6"],MINOR_REGEXP:/comment|combx|disqus|foot|header|menu|rss|shoutbox|sidebar|sponsor/i,MAJOR_REGEXP:/article|entry|post|body|column|main|content/i,TINY_REGEXP:/comment/i,BLANK_REGEXP:/\S/i,debugWeight:function(){this.elem.setAttribute("debug-weight",this.weight),this.elem.setAttribute("debug-offset-x",this.offset.x),this.elem.setAttribute("debug-offset-y",this.offset.y),this.elem.setAttribute("debug-weight-struct",this.calcStructWeight()),this.elem.setAttribute("debug-weight-content",this.calcContentWeight())},_getAllTexts:function(b,c){var d=[];if(c>0)for(var e=b.firstChild;e;){if(3==e.nodeType&&this._checkLength(e)){var f=e.parentNode||{},g=f.parentNode||{};this._checkMinorContent(f)||this._checkMinorContent(g)||!a.trim(e.nodeValue)||d.push(e)}else 1==e.nodeType&&this._checkTagName(e)&&(d=d.concat(this._getAllTexts(e,c-1)));e=e.nextSibling}return d},calcStructWeight:function(){for(var b=0,c=0,d=this._texts.length;d>c;c++){var e=this._texts[c],f=a.trim(e.nodeValue).length,g=1;if(!(20>f)){for(var h=e.parentNode;h&&h!=this.elem;h=h.parentNode)g-=.1;b+=Math.pow(g*f,1.25)}}return b},calcContentWeight:function(){for(var a=1,b=this.elem;b;b=b.parentNode)b.id&&(this.MAJOR_REGEXP.test(b.id)&&(a+=.4),this.MINOR_REGEXP.test(b.id)&&(a-=.8)),b.className&&(this.MAJOR_REGEXP.test(b.className)&&(a+=.4),this.MINOR_REGEXP.test(b.className)&&(a-=.8));return a},calcWeight:function(){return this.calcStructWeight()*this.calcContentWeight()},_checkTagName:function(b){return-1==a.indexOf(this.IGNORE_TAGS,b.tagName)},_checkTitle:function(){for(var b=this.elem.getElementsByTagName("*"),c=[],d=0;b[d];d++)a.indexOf(this.TITLE_TAGS,b[d].tagName)>-1&&c.push(b[d]);if(c.length>2){for(var e=this.elem.offsetHeight,f=0,g=a.findPos(this.elem),h=.05*e,i=0;c[i];i++){var j=a.findPos(c[i]);j.y-g.y>h&&j.y+c[i].offsetHeight-(g.y+e)&&f++}if(300>e/f)return!0}return!1},_checkLength:function(a){return Boolean(this.BLANK_REGEXP.test(a.nodeValue))},_checkMinorContent:function(a){return Boolean(this.TINY_REGEXP.test(a.id+" "+a.className))},_checkVisibility:function(b){return!("hidden"==a.css(b,"visibility")||"none"==a.css(b,"display")||parseInt(a.css(b,"height"))<=0||parseInt(a.css(b,"width"))<=0)}},b}),sg_define("pe/Bread",function(){var a=sg_require("pe/Util"),b=sg_require("pe/BreadCrumb"),c=function(a,b){this.win=a,this.contentDocument=b};return c.prototype={IGNORE_TAGS:["HTML","HEAD","META","TITLE","SCRIPT","STYLE","LINK","IMG","FORM","INPUT","BODY","BUTTON","TEXTAREA","SELECT","OPTION","LABEL","IFRAME","UL","OL","LI","DD","DL","DT","A","OBJECT","PARAM","EMBED","NOSCRIPT","EM","B","STRONG","I","INS","BR","HR","PRE","H1","H2","H3","H4","H5","CITE"],getMainBreadCrumb:function(){var a=null,b=this.getAllBreadCrumb();if(!b||!b.length)return null;b.sort(function(a,b){return b.weight-a.weight});for(var c=0;2>c&&(a=b[0],b.splice(0,1),a&&a.weight<500&&(a=null),!a);c++);return a?a:null},getAllBreadCrumb:function(){for(var a=this.contentDocument.getElementsByTagName("*"),c=[],d=0,e=a.length;e>d;d++){var f=a[d];this._checkTagName(f)&&this._checkSize(f)&&this._checkVisibility(f)&&(c[c.length]=new b(f))}return c},_checkTagName:function(b){return-1==a.indexOf(this.IGNORE_TAGS,b.tagName)},_checkVisibility:function(b){return!("hidden"==a.css(b,"visibility")||"none"==a.css(b,"display")||parseInt(a.css(b,"height"))<=0||parseInt(a.css(b,"width"))<=0)},_checkSize:function(a){return a.offsetHeight>20&&a.offsetHeight<60}},c}),sg_define("pe/BreadCrumb",function(){var a=sg_require("pe/Util"),b=function(b){this.elem=b,this.offset=a.findPos(b),this.text=a.getInnerText(b),this.weight=this.calcWeight()};return b.prototype={MINOR_REGEXP:/foot|header|menu|rss|navigat/i,MAJOR_REGEXP:/bread|crumb|current|path|position|mypos/i,BLANK_REGEXP:/\S/i,SPECIAL_CHAR_CODE:[62,187,8594,12299],debugWeight:function(){this.elem.setAttribute("crumb-weight",this.weight),this.elem.setAttribute("crumb-offset-x",this.offset.x),this.elem.setAttribute("crumb-offset-y",this.offset.y),this.elem.setAttribute("crumb-weight-struct",this.calcStructWeight()),this.elem.setAttribute("crumb-weight-content",this.calcContentWeight()),this.elem.setAttribute("crumb-weight-verify",this.calcVerifyWeight())},calcStructWeight:function(){var a=0,b=this._trimSpecialChar(this.text),c=this._countSpecialChar(b);a+=500*c;var d=b.length;return a+=30-d,this._checkPositionX()?a+=20:a-=20,this._checkWidth()?a+=20:a-=20,a},calcContentWeight:function(){for(var a=1,b=this.elem;b;b=b.parentNode)b.id&&(this.MAJOR_REGEXP.test(b.id)&&(a+=.4),this.MINOR_REGEXP.test(b.id)&&(a-=.2)),b.className&&(this.MAJOR_REGEXP.test(b.className)&&(a+=.4),this.MINOR_REGEXP.test(b.className)&&(a-=.2));return a},calcVerifyWeight:function(){var a=1;return this._checkBlank(this.text)||(a=0),this._checkLinkPattern()||(a=0),this._checkPositionY()||(a=0),a},calcWeight:function(){return this.calcStructWeight()*this.calcContentWeight()*this.calcVerifyWeight()},_checkBlank:function(a){return Boolean(this.BLANK_REGEXP.test(a))},_hasSpecialChar:function(a){var b=!1;if("string"==typeof a)for(var c=0;c<a.length;c++){var d=a.charCodeAt(c);for(var e in this.SPECIAL_CHAR_CODE){var f=this.SPECIAL_CHAR_CODE[e];if(f==d){b=!0;break}}if(b)break}return b},_countSpecialChar:function(a){for(var b=0,c=a.length,d=0;c>d;d++){var e=a.charAt(d);this._hasSpecialChar(e)&&b++}return b},_trimSpecialChar:function(a){return"string"!=typeof a?a:a.replace(/^>+/,"").replace(/>+$/,"")},_checkLinkPattern:function(){for(var b=this.elem,c=b.childNodes,d=c.length,e=0,f=0;d>f;f++){var g=c[f];if(1==g.nodeType&&"A"==g.tagName){var h=a.getInnerText(g);h.length>0&&e++}else if(3==g.nodeType){var i=g.nodeValue;i=a.trim(i),this._hasSpecialChar(i)&&e>0&&e--}else if(1==g.nodeType&&"A"!=g.tagName){var i=a.getInnerText(g);this._hasSpecialChar(i)&&e>0&&e--}if(e>1)return!1}return!0},_checkPositionY:function(){var a=this.offset.y+this.elem.offsetHeight,b=2*window.screen.height/3;return b>a},_checkPositionX:function(){var a=this.offset.x+this.elem.offsetWidth,b=4*window.screen.width/5;return b>a},_checkWidth:function(){var a=this.elem.offsetWidth,b=1*window.screen.width/2;return b>a}},b}),sg_define("pe/Uploader",function(){var a=sg_require("pe/Util"),b=sg_require("pe/Config"),c=function(a,b){this.win=a,this.contentDocument=b,this.init()};return a.extend(c.prototype,{init:function(){var c=this.contentDocument.body,d=a.mkel("div",c);this.ifameContainer=d,a.extend(d.style,{display:"none"});var e="";e+='<iframe width="1" height="1" src="javascript:document.write(\'\');"',e+='id="'+b.form.IfameName+'" name="'+b.form.IfameName+'">',e+="</iframe>",d.innerHTML=e},getNavigatorSign:function(){var a=navigator.userAgent.toLowerCase(),b=/msie/.test(a)?parseFloat(a.match(/msie ([\d.]+)/)[1]):!1;return parseInt(b)>=7?"true":"false"},buildForm:function(){var c=this.contentDocument.body,d=a.mkel("div",c);this.formContainer=d,a.extend(d.style,{display:"none"});var e=a.mkel("form",d);this.uploadForm=e,a.extend(e,{id:b.form.FormName,name:b.form.FormName,action:b.form.UploadUrl,target:b.form.IfameName,enctype:"application/x-www-form-urlencoded",encoding:"application/x-www-form-urlencoded",method:"POST"});var f=b.doc.maincontent||"";f=f.replace(/[\r\n]/g,"");var g="";g+='<input type="text" name="url" value="'+b.doc.url+'"/>',g+='<textarea name="title">'+b.doc.title+"</textarea>",g+='<textarea name="mypos">'+b.doc.mypos+"</textarea>",g+='<textarea name="metakeywords">'+b.doc.metakeywords+"</textarea>",g+='<textarea name="metadescription">'+b.doc.metadescription+"</textarea>",g+='<input type="text" name="lastmodified" value="'+b.doc.lastmodified+'"/>',g+='<input type="text" name="charset" value="'+b.doc.charset+'"/>',g+='<textarea name="maincontent">'+f+"</textarea>",e.innerHTML=g},removeForm:function(){this.formContainer.innerHTML="",this.ifameContainer.innerHTML=""},upload:function(){this.buildForm(),this.uploadForm.submit()}}),c}),sg_define("AppMain",function(){function a(a,b){var c="";if("html"==b)c=a.elem.innerHTML;else for(var d=a._texts,e=0,f=d.length;f>e;e++){var g=d[e];c+=g.nodeValue}return c}var b=sg_require("pe/Util"),c=sg_require("pe/Config"),d=sg_require("pe/Uploader"),e=sg_require("pe/Page"),f=sg_require("pe/Article"),g=sg_require("pe/Bread"),h=sg_require("pe/BreadCrumb"),i=b.getTopWindowInSameDomain(window)||window,j=i.document,k=new e(i,j),l=new g(i,j),m="SOGOU_STAR_URL_DATA",n=window[m];if(n){var o=n.specialcase,p=n.selector,q=n.contenttype,r=n.mypos_sc,s=n.mypos_s,t=n.mypos_ct,u=null,v=null;if(!(o>0||r>0)||j.querySelector){if(1==o){var w=j.querySelector(p);w&&(u=new f(w))}else if(o>1){var x=j.querySelectorAll(p);if(x&&x.length>0){v=new Array;for(var y=0;y<x.length;y++){var w=x[y];v.push(new f(w))}}}u||v&&!(v.length<1)||(u=k.getMainArticle());var z="";if(u)z=a(u,q);else if(v)for(var y in v){var u=v[y];z+=a(u,q)}else z="";z=z.replace(/[\r\n]/g,"");var A=null;if(1==r){var w=j.querySelector(s);w&&(A=new h(w))}A||(A=l.getMainBreadCrumb());var B="";A&&(B="html"==t?A.elem.innerHTML:A.text,B=B.replace(/[\r\n]/g,"")),c.doc.url=k.getUrl(),c.doc.title=k.getTitle(),c.doc.mypos=B,c.doc.metakeywords=k.getMetaKeywords(),c.doc.metadescription=k.getMetaDescription(),c.doc.lastmodified=k.getLastModified(),c.doc.charset=k.getCharset(),c.doc.maincontent=z;var C=new d(i,j);C.upload()}}});